$(document).ready((function(){const o={practical:["What are some common collocations with [word]?","Does [word] have any idiomatic uses or expressions?","Can you provide some example sentences showing [word] in context?","Are there any common mistakes people make when using [word]?"],formality:["Is [word] formal or informal?","What are some more formal alternatives to [word]?","What are some more informal alternatives to [word]?","Are there situations where [word] is inappropriate or too formal/informal?","How does the formality of [word] change in different contexts?"],synonyms:["In a nutshell, what is the difference between [word] and ...?","What are some synonyms of [word]?","What are some antonyms of [word]?"],context:["Is the term [word] used more in written or spoken language?","In what professions or fields is [word] most commonly used?","How does the use of [word] vary by region or country?","Does the term [word] have different nuances depending on the cultural context?","How is [word] commonly pronounced in different regions or accents?","Are there any social situations where the use of the term [word] should be avoided?"],pop:["How has the meaning of [word] evolved in recent years?","Has [word] gained or lost popularity over time?","What current cultural references prominently feature [word]?","How do different generations use [word] differently?"]};function e(o,e){return o.replace(/\[word\]/g,`"${e}"`)}$("#ask-ai-bot-modal").on("show.bs.modal",(function(){$("#prompt-category").val(""),$("#prompt-select").attr("disabled",!0).empty().append('<option value="">First select a category...</option>'),$("#custom-prompt").val(""),$("#prompt-form").show(),$("#ai-answer").hide(),$("#text-ai-answer").val(""),$("#back-footer").hide(),$("#normal-footer").show()})),$("#prompt-category").change((function(){const t=$(this).val(),a=$("#prompt-select"),r=$("#ask-ai-bot-modal").attr("data-word");t?(a.removeAttr("disabled").empty().append('<option value="">Choose a prompt...</option>'),o[t].forEach(((o,t)=>{const n=e(o,r);a.append(`<option value="${t}">${n}</option>`)}))):(a.attr("disabled",!0).empty().append('<option value="">First select a category...</option>'),$("#custom-prompt").val(""))})),$("#prompt-select").change((function(){const t=$("#prompt-category").val(),a=$(this).val(),r=$("#ask-ai-bot-modal").attr("data-word");if(""!==a){const n=e(o[t][a],r);$("#custom-prompt").val(n)}else $("#custom-prompt").val("")})),$("#btn-ask-ai-bot").click((async function(){const o=$("#custom-prompt").val();if(o){const t=e(o,$("#ask-ai-bot-modal").attr("data-word"));$("#prompt-form").hide(),$("#ai-answer").show(),$("#normal-footer").hide(),$("#back-footer").show(),$("#text-ai-answer").val("");let a=!0;try{const o=await fetch("/ajax/getaireply.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`prompt=${encodeURIComponent(t)}`});if(!o.ok)throw new Error("Failed to get AI response");const e=o.body.getReader(),r=new TextDecoder;for(;;){const{value:o,done:t}=await e.read();if(t)break;let n=r.decode(o,{stream:!0});a&&(n=n.trimStart(),a=!1),$("#text-ai-answer").val($("#text-ai-answer").val()+n)}}catch(o){$("#text-ai-answer").val("Failed to get response from AI. Please try again.")}}})),$(document).on("click","#back-to-form",(function(){$("#back-footer").hide(),$("#normal-footer").show(),$("#ai-answer").hide(),$("#text-ai-answer").val(""),$("#prompt-form").show()}))}));
function toggleDictation(){if(""!=$("#audioplayer").find("source").attr("src")){let t=$("#text").clone(),e=t.find(".word"),o=$(".word");0==$(".dict-answer").length?(e.each((function(t,e){let a=$(this);const n=a.text().length,i=o.eq(t).width(),s=o.eq(t).css("font-size");let r="";a.hasClass("learned")?r="green":a.hasClass("learning")?r="orange":a.hasClass("new")?r="DodgerBlue":a.hasClass("forgotten")&&(r="crimson"),a.hide().after('<div class="input-group dict-input-group"><input type="text" class="dict" style="width:'+i+"px; line-height:"+s+"; border-color:"+r+';" maxlength="'+n+'" data-text="'+a.text()+'"><span class="dict-answer d-none"></span></div>')})),$("#text").replaceWith(t),scrollToPageTop(),audioController.playFromBeginning(),$(":text:first").focus()):(e.each((function(t,e){$(this).show().nextAll(":lt(1)").remove()})),$("#text").replaceWith(t),scrollToPageTop(),audioController.stop())}}$(document).ready((function(){$("body").on("blur",".dict",(function(){let t=$(this);t.val().toLowerCase()==t.attr("data-text").toLowerCase()?(t.css("border-color","green"),t.next("span").not(".d-none").addClass("d-none")):""!=$.trim(t.val())&&(t.css("border-color","crimson"),t.next("span").removeClass("d-none").addClass("dict-wronganswer").text("[ "+t.attr("data-text")+" ]"))})),$("body").on("keydown",".dict",(function(t){const e=t.keyCode||t.which;if(!t.isComposing&&0!=e&&229!=e&&!$(this).val())if(8==e){const e=$(".dict").index(this)-1;t.preventDefault(),$(".dict").eq(e).focus()}else 32==e&&t.preventDefault()})),$("body").on("input",".dict",(function(t){let e=t.keyCode||t.which;const o=$(this).attr("maxlength"),a=$("#audioplayer")[0].currentTime;switch(0!=e&&229!=e||(e=t.target.value.charAt(t.target.selectionStart-1).charCodeAt()),e){case 8:if(!$(this).val()){const t=$(".dict").index(this)-1;$(".dict").eq(t).focus()}break;case 49:$("#audioplayer")[0].currentTime=a-5;break;case 50:audioController.togglePlayPause();break;case 51:$("#audioplayer")[0].currentTime=a+5;break;default:break}if($(this).val($(this).val().replace(/\d/gi,"")),o==$(this).val().length&&!t.originalEvent.isComposing){const t=$(".dict").index(this)+1;$(".dict").eq(t).focus()}}))}));
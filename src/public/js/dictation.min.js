function toggleDictation(){if(""!=$("#audioplayer").find("source").attr("src")){let e=$("#text").clone(),t=e.find(".word"),a=$(".word");0==$(".dict-answer").length?(t.each((function(e,t){let n=$(this);const i=n.text().length,o=a.eq(e).width(),s=a.eq(e).css("font-size");let r="";n.hasClass("learned")?r="green":n.hasClass("learning")?r="orange":n.hasClass("new")?r="DodgerBlue":n.hasClass("forgotten")&&(r="crimson"),n.hide().after('<div class="input-group dict-input-group"><input type="text" class="dict" style="width:'+o+"px; line-height:"+s+"; border-color:"+r+';" maxlength="'+i+'" data-text="'+n.text()+'"><span class="dict-answer d-none"></span></div>')})),$("#text").replaceWith(e),scrollToPageTop(),$("#range-speed").trigger("change",[{cpbr:.5}]),playAudioFromBeginning(),$(":text:first").focus()):(t.each((function(e,t){$(this).show().nextAll(":lt(1)").remove()})),$("#text").replaceWith(e),scrollToPageTop(),stopAudio())}}$(document).ready((function(){$("body").on("blur",".dict",(function(){let e=$(this);e.val().toLowerCase()==e.attr("data-text").toLowerCase()?(e.css("border-color","green"),e.next("span").not(".d-none").addClass("d-none")):""!=$.trim(e.val())&&(e.css("border-color","crimson"),e.next("span").removeClass("d-none").addClass("dict-wronganswer").text("[ "+e.attr("data-text")+" ]"))})),$("body").on("keydown",".dict",(function(e){const t=e.keyCode||e.which;if(!e.isComposing&&0!=t&&229!=t&&!$(this).val())if(8==t){const t=$(".dict").index(this)-1;e.preventDefault(),$(".dict").eq(t).focus()}else 32==t&&e.preventDefault()})),$("body").on("input",".dict",(function(e){let t=e.keyCode||e.which;const a=$(this).attr("maxlength"),n=$("#audioplayer")[0].currentTime;switch(0!=t&&229!=t||(t=e.target.value.charAt(e.target.selectionStart-1).charCodeAt()),t){case 8:if(!$(this).val()){const e=$(".dict").index(this)-1;$(".dict").eq(e).focus()}break;case 49:$("#audioplayer")[0].currentTime=n-5;break;case 50:togglePlayPause();break;case 51:$("#audioplayer")[0].currentTime=n+5;break;default:break}if($(this).val($(this).val().replace(/\d/gi,"")),a==$(this).val().length&&!e.originalEvent.isComposing){const e=$(".dict").index(this)+1;$(".dict").eq(e).focus()}}))}));
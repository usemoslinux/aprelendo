const WordSelection=(()=>{let t=null;return{setupEvents:function({actionBtns:e,controller:n,linkBuilder:o}){let i=!1,s=-1,r=-1,c=null,u=null,l=null;const a=$(parent.document);function g(t){i=!1,c=t.pageX,u=t.pageY,l=setTimeout((function(){i=!0,n.pause(!0)}),500)}function h(){clearTimeout(l),c=null,u=null}function f(t){(function(t){if(null==c||null==u)return!1;const e=t.pageX-c,n=t.pageY-u;return Math.abs(e)>10||Math.abs(n)>10})(t)&&h(),i&&function(t){if(!i||s<0)return;const e=document.elementFromPoint(t.clientX,t.clientY),n=$(e).closest("a");n.length&&(r=TextProcessor.getAnchorIndex(n),TextHighlighter.removeAll(),TextHighlighter.addSelection(s,r))}(t)}function d(){if(i&&s>=0&&r>=0){TextProcessor.getAnchorsList().eq(s).parent()[0]===TextProcessor.getAnchorsList().eq(r).parent()[0]&&(t=TextHighlighter.getSelection(s,r),e.show(t))}h(),i=!1,s=-1,r=-1}a.on("contextmenu",(function(e){if(e.preventDefault(),e.stopPropagation(),$(e.target).is("#text .word")){n.pause(!1),t=$(e.target);const i=Dictionaries.getURIs();openInNewTab(o(i.translator,t))}return!1})),a.on("click","#text .word",(function(o){i||(t=$(this),TextHighlighter.removeAll(),t.addClass("highlighted"),e.hide(),n.pause(!0),e.show(t))})),a.on("mousedown touchstart","#text .word",(function(t){s=TextProcessor.getAnchorIndex($(this))})),a.on("mousedown","#text",(function(t){g(t)})),a.on("mousemove","#text",(function(t){f(t)})),a.on("mouseup","#text",(function(t){d()})),a.on("touchstart","#text",(function(t){g(t.originalEvent.touches[0])})),a.on("touchmove","#text",(function(t){f(t.originalEvent.touches[0])})),a.on("touchend","#text",(function(t){d()})),a.on("mouseup touchend",(function(t){if($("#action-buttons").is(":visible")){const o=$(t.target).is(".word"),i=$(t.target).closest(".btn").length>0,s=$(t.target).closest(".offcanvas").length>0,r=$(t.target).closest(".modal").length>0;o||i||s||r||(t.stopPropagation(),TextHighlighter.removeAll(),e.hide(),n.resume())}}))},get:()=>t}})();
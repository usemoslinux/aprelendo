const WordSelection=(()=>{let t=null;return{setupEvents:function({actionBtns:e,controller:n,linkBuilder:o}){let i=!1,c=-1,l=-1,s=null,u=null,r=null;const h=$(parent.document);function a(t){i=!1,s=t.pageX,u=t.pageY,r=setTimeout((function(){i=!0,n.pause(!0)}),500)}function g(){clearTimeout(r),s=null,u=null}function f(t){(function(t){if(null==s||null==u)return!1;const e=t.pageX-s,n=t.pageY-u;return Math.abs(e)>10||Math.abs(n)>10})(t)&&g(),i&&function(t){if(!i||c<0)return;const e=document.elementFromPoint(t.clientX,t.clientY),n=$(e).closest("a");n.length&&(l=TextProcessor.getAnchorIndex(n),TextHighlighter.removeAll(),TextHighlighter.addSelection(c,l))}(t)}function d(){if(i&&c>=0&&l>=0){TextProcessor.getAnchorsList().eq(c).parent()[0]===TextProcessor.getAnchorsList().eq(l).parent()[0]&&(t=TextHighlighter.getSelection(c,l),e.show(t))}g(),i=!1,c=-1,l=-1}h.on("contextmenu",(function(t){return t.preventDefault(),!1})),h.on("click","#text .word",(function(o){i||(t=$(this),TextHighlighter.removeAll(),t.addClass("highlighted"),e.hide(),n.pause(!0),e.show(t))})),h.on("mousedown touchstart","#text .word",(function(t){c=TextProcessor.getAnchorIndex($(this))})),h.on("mousedown","#text",(function(e){if(e.originalEvent.which<2)a(e);else if(3===e.originalEvent.which){n.pause(!1),t=$(e.target);Dictionaries.getURIs()}})),h.on("mousemove","#text",(function(t){f(t)})),h.on("mouseup","#text",(function(t){d()})),h.on("touchstart","#text",(function(t){a(t.originalEvent.touches[0])})),h.on("touchmove","#text",(function(t){f(t.originalEvent.touches[0])})),h.on("touchend","#text",(function(t){d()})),h.on("mouseup touchend",(function(t){if($("#action-buttons").is(":visible")){const o=$(t.target).is(".word"),i=$(t.target).closest(".btn").length>0,c=$(t.target).closest(".offcanvas").length>0,l=$(t.target).closest(".modal").length>0;o||i||c||l||(t.stopPropagation(),TextHighlighter.removeAll(),e.hide(),n.resume())}}))},get:()=>t}})();
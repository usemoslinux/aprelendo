const WordSelection=(()=>{let t=null;return{setupEvents:function({actionBtns:n,controller:o,linkBuilder:i}){let r=!1,s=-1,c=-1,u=null,l=null,a=null;const g=$(parent.document);function h(t){r=!1,u=t.pageX,l=t.pageY,a=setTimeout((function(){r=!0,o.pause(!0)}),500)}function d(){clearTimeout(a),u=null,l=null}function f(t){(function(t){if(null==u||null==l)return!1;const e=t.pageX-u,n=t.pageY-l;return Math.abs(e)>10||Math.abs(n)>10})(t)&&d(),r&&p()}function p(){if(!r||s<0)return;const t=document.elementFromPoint(e.clientX,e.clientY),n=$(t).closest("a");n.length&&(c=TextProcessor.getAnchorIndex(n),TextHighlighter.removeAll(),TextHighlighter.addSelection(s,c))}function x(){if(r&&s>=0&&c>=0){TextProcessor.getAnchorsList().eq(s).parent()[0]===TextProcessor.getAnchorsList().eq(c).parent()[0]&&(t=TextHighlighter.getSelection(s,c),n.show(t))}d(),r=!1,s=-1,c=-1}g.on("contextmenu",(function(e){if(e.preventDefault(),e.stopPropagation(),$(e.target).is("#text .word")&&"mouse"===e.pointerType){o.pause(!1),t=$(e.target);const n=Dictionaries.getURIs();openInNewTab(i(n.translator,t)),d()}return!1})),g.on("click","#text .word",(function(e){r||(t=$(this),TextHighlighter.removeAll(),t.addClass("highlighted"),n.hide(),o.pause(!0),n.show(t))})),g.on("mousedown touchstart","#text .word",(function(t){s=TextProcessor.getAnchorIndex($(this))})),g.on("mousedown","#text .word",(function(t){h(t)})),g.on("mousemove","#text .word",(function(t){f(t)})),g.on("mouseup","#text .word",(function(t){x()})),g.on("touchstart","#text .word",(function(t){h(t.originalEvent.touches[0])})),g.on("touchmove","#text .word",(function(t){f(t.originalEvent.touches[0])})),g.on("touchend","#text .word",(function(t){x()})),g.on("mouseup touchend",(function(t){if($("#action-buttons").is(":visible")){const e=$(t.target).is(".word"),i=$(t.target).closest(".btn").length>0,r=$(t.target).closest(".offcanvas").length>0,s=$(t.target).closest(".modal").length>0;e||i||r||s||(t.stopPropagation(),TextHighlighter.removeAll(),n.hide(),o.resume())}}))},get:()=>t}})();
const WordSelection=(()=>{let t=null;return{setupEvents:function({actionBtns:e,controller:n,linkBuilder:o}){let i=!1,c=-1,s=-1,l=null,r=null,u=null;const a=$(parent.document);function h(t){i=!1,l=t.pageX,r=t.pageY,u=setTimeout((function(){i=!0,n.pause(!0)}),500)}function g(){clearTimeout(u),l=null,r=null}function f(t){(function(t){if(null==l||null==r)return!1;const e=t.pageX-l,n=t.pageY-r;return Math.abs(e)>10||Math.abs(n)>10})(t)&&g(),i&&function(t){if(!i||c<0)return;const e=document.elementFromPoint(t.clientX,t.clientY),n=$(e).closest("a");n.length&&(s=TextProcessor.getAnchorIndex(n),TextHighlighter.removeAll(),TextHighlighter.addSelection(c,s))}(t)}function d(){if(i&&c>=0&&s>=0){TextProcessor.getAnchorsList().eq(c).parent()[0]===TextProcessor.getAnchorsList().eq(s).parent()[0]&&(t=TextHighlighter.getSelection(c,s),e.show(t))}g(),i=!1,c=-1,s=-1}a.on("contextmenu",(function(t){return t.preventDefault(),!1})),a.on("click","#text .word",(function(o){i||(t=$(this),TextHighlighter.removeAll(),t.addClass("highlighted"),e.hide(),n.pause(!0),e.show(t))})),a.on("mousedown touchstart","#text .word",(function(t){c=TextProcessor.getAnchorIndex($(this))})),a.on("mousedown","#text",(function(e){if(e.originalEvent.which<2)h(e);else if(3===e.originalEvent.which){n.pause(!1),t=$(e.target);const i=Dictionaries.getURIs();openInNewTab(o(i.translator,t))}})),a.on("mousemove","#text",(function(t){f(t)})),a.on("mouseup","#text",(function(t){d()})),a.on("touchstart","#text",(function(t){h(t.originalEvent.touches[0])})),a.on("touchmove","#text",(function(t){f(t.originalEvent.touches[0])})),a.on("touchend","#text",(function(t){d()})),a.on("mouseup touchend",(function(t){if($("#action-buttons").is(":visible")){const o=$(t.target).is(".word"),i=$(t.target).closest(".btn").length>0,c=$(t.target).closest(".offcanvas").length>0,s=$(t.target).closest(".modal").length>0;o||i||c||s||(t.stopPropagation(),TextHighlighter.removeAll(),e.hide(),n.resume())}}))},get:()=>t}})();
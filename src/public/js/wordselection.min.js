const WordSelection=(()=>{let t=null;return{setupEvents:function({actionBtns:e,controller:n,linkBuilder:o}){let i=!1,r=-1,s=-1,l=null,c=null,u=null;const a=$(parent.document);function g(t){i=!1,l=t.pageX,c=t.pageY,u=setTimeout((function(){i=!0,n.pause(!0)}),500)}function h(){clearTimeout(u),l=null,c=null}function d(t){(function(t){if(null==l||null==c)return!1;const e=t.pageX-l,n=t.pageY-c;return Math.abs(e)>10||Math.abs(n)>10})(t)&&h(),i&&function(t){if(!i||r<0)return;const e=document.elementFromPoint(t.clientX,t.clientY),n=$(e).closest("a");n.length&&(s=TextProcessor.getAnchorIndex(n),TextHighlighter.removeAll(),TextHighlighter.addSelection(r,s))}(t)}function f(){if(i&&r>=0&&s>=0){TextProcessor.getAnchorsList().eq(r).parent()[0]===TextProcessor.getAnchorsList().eq(s).parent()[0]&&(t=TextHighlighter.getSelection(r,s),e.show(t))}h(),i=!1,r=-1,s=-1}a.on("contextmenu",(function(e){if(e.preventDefault(),e.stopPropagation(),$(e.target).is("#text .word")&&"mouse"===e.pointerType){n.pause(!1),TextHighlighter.removeAll();const i=$(e.target);t=i,i.addClass("highlighted");const r=Dictionaries.getURIs();openInNewTab(o(r.translator,t)),h()}return!1})),a.on("click","#text .word",(function(o){i||(t=$(this),TextHighlighter.removeAll(),t.addClass("highlighted"),e.hide(),n.pause(!0),e.show(t))})),a.on("mousedown touchstart","#text .word",(function(t){r=TextProcessor.getAnchorIndex($(this))})),a.on("mousedown","#text .word",(function(t){g(t)})),a.on("mousemove","#text .word",(function(t){d(t)})),a.on("mouseup","#text .word",(function(t){f()})),a.on("touchstart","#text .word",(function(t){g(t.originalEvent.touches[0])})),a.on("touchmove","#text .word",(function(t){d(t.originalEvent.touches[0])})),a.on("touchend","#text .word",(function(t){f()})),a.on("mouseup touchend",(function(t){if($("#action-buttons").is(":visible")){const o=$(t.target).is(".word"),i=$(t.target).closest(".btn").length>0,r=$(t.target).closest(".offcanvas").length>0,s=$(t.target).closest(".modal").length>0;o||i||r||s||(t.stopPropagation(),TextHighlighter.removeAll(),e.hide(),n.resume())}}))},get:()=>t}})();
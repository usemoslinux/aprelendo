$(document).ready((function(){let t={s:new URLSearchParams(window.location.search).get("s")||"",o:new URLSearchParams(window.location.search).get("o")||0,ft:new URLSearchParams(window.location.search).get("ft")||0,fl:new URLSearchParams(window.location.search).get("fl")||0,p:new URLSearchParams(window.location.search).get("p")||1};async function e(){$("#shared-texts-loader").removeClass("d-none"),$("#shared-texts-content").addClass("opacity-50");try{const e=new URLSearchParams(t).toString(),a=await fetch(`/ajax/getsharedtexts.php?${e}`);if(!a.ok)throw new Error(`HTTP error: ${a.status}`);const o=await a.json();if(!o.success)throw new Error(o.error_msg||"Failed to fetch shared texts");$("#shared-texts-content").html(o.payload.html);const n=window.location.pathname+"?"+e;window.history.pushState(t,"",n),"undefined"!=typeof Tooltips&&Tooltips.init()}catch(t){$("#shared-texts-content").html(`<div class="alert alert-danger">Error: ${t.message}</div>`)}finally{$("#shared-texts-loader").addClass("d-none"),$("#shared-texts-content").removeClass("opacity-50")}}e(),$("#shared-texts-filter-form").on("submit",(function(a){a.preventDefault(),t.s=$("#s").val().trim(),t.p=1,e()})),$(document).on("click","#filter-dropdown .dropdown-item",(function(a){a.preventDefault();const o=$(this),n=o.is(".ft"),s=n?".ft":".fl";o.parent().find(s+".active").removeClass("active"),o.addClass("active"),n?t.ft=o.data("value")||0:t.fl=o.data("value")||0,t.p=1,e()})),$(document).on("click","#dropdown-menu-sort .o",(function(a){a.preventDefault(),t.o=$(this).data("value")||0,t.p=1,e()})),$(document).on("click",".pagination a",(function(a){a.preventDefault();const o=new URL($(this).attr("href"),window.location.origin);t.p=o.searchParams.get("p")||1,e()})),window.onpopstate=function(a){a.state&&(t=a.state,$("#s").val(t.s),e())}}));
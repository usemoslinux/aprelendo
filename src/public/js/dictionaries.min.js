const Dictionaries=(()=>{let e={dictionary:"",img_dictionary:"",translator:""};return{fetchURIs:()=>{$.ajax({url:"/ajax/getdicuris.php",type:"GET",dataType:"json"}).done((function(n){null==n.error_msg&&(e.dictionary=n.dictionary_uri,e.img_dictionary=n.img_dictionary_uri,e.translator=n.translator_uri)}))},getWordFrequency:e=>100==e?"Medium/low":e<81?"Very high":e<97?"High":void 0,getURIs:()=>e}})(),SentenceExtractor=(()=>{const e={universal:["etc.","et al.","Mr.","Ms.","Mrs.","Dr.","Prof."],ar:[],bg:["т.е.","и т.н.","и др."],ca:["p. ex.","p. s."],zh:[],hr:["npr.","itd.","dr.","str."],cs:["tj.","atd.","č. p.","str."],da:["dvs.","osv."],nl:["d.w.z.","enz."],en:["Rev.","St.","No.","Jr.","Sr.","Ph.D."],fr:["M.","Mme.","Mlle.","p. ex.","p. j."],de:["z.B.","u.a.","d.h.","usw.","Nr."],el:["π.χ.","κ.λπ."],he:["וכו.",'ד"ר.'],hi:["डॉ.","श्री."],hu:["pl.","stb.","u.ö."],it:["Sig.","Sig.ra","ecc.","p.es.","dott."],ja:[],ko:[],no:["dvs.","osv."],pl:["np.","itp.","dr."],pt:["Sr.","Sra.","Dra.","p. ex."],ro:["d-l.","d-na.","ș.a.m.d."],ru:["т.е.","и т.д.","с. (стр.)"],sk:["tzn.","atď."],sl:["npr.","ipd."],es:["Sr.","Sra.","Dra.","p. ej."],sv:["t.ex.","dvs.","osv."],tr:["örn.","vb."],vi:["v.v.","Tp."]};let n;function t(e,n,t){let o=n,r=0,s=$(e[o]).text().length;for(;1===s;){"."===$(e[o+t]).text().trim()?(r+=2,o+=2*t):o+=t,s=$(e[o+t]).text().length}return r}function o(e,t,o){const r=1===o?$(e[t]).text():$(e[t-2]).text();return n.some((e=>r===e))}function r(e,n){const t=[...n.single.open,...n.double.open],o=[...n.single.close,...n.double.close];t.includes(e[e.length-1])&&(e=e.slice(0,-1));const r=function(e,n,t){for(let o=0;o<n.length;o++)if(n[o]===t[o]){const t=new RegExp(n[o]+"(?=$|\\W)","gu");if((e.match(t)||[]).length%2!=0)return n[o]}for(let o=0;o<n.length;o++)if(n[o]!==t[o]){const r=new RegExp(n[o]+"(?=$|\\W)","gu");let s=e.split(r).length-1;const l=new RegExp(t[o]+"(?=$|\\W)","gu");if(e.split(l).length-1>s){let r=0;for(const s of e)if(s===n[o])r++;else if(s===t[o]){if(!(r>0))return n[o];r--}}}return""}(e,t,o);return r&&(e=r+e),e}return{extractSentence:function(s){let l=/[.!?\u3002\uFF01\uFF1F](?=\s|$)/;const c=TextProcessor.getAnchorsList(),i=TextProcessor.getAnchorIndex(s);if(i<0||i>=c.length)return"";const p=$("#text").data("text-lang");!function(t){if(n=[],e.universal){const t=e.universal.map((e=>{const n=RegExp(/(\w+)\W*$/u).exec(e);return n?n[1]:e}));n.push(...t)}if(e[t]){const o=e[t].map((e=>{const n=RegExp(/(\w+)\W*$/u).exec(e);return n?n[1]:e}));n.push(...o)}}(p);let u=i;for(;u>0;){const e=$(c[u-1]).text();if(l.test(e)){const e=t(c,u-2,-1);if(e)u-=e+2;else{if(!o(c,u,-1))break}}u--}let a=i;for(;a<c.length-1;){const e=$(c[a+1]).text();if(l.test(e)){const e=t(c,a,1);if(e)a+=e;else{if(!o(c,a,1)){a++;break}}}a++}l=/[.!?\u3002\uFF01\uFF1F]/;let d=function(e,n,t,o,r){let s="";for(let l=n;l<=t;l++){const n=$(e[l]).text();if(/[\r\n]/.test(n)){const e=n.match(r);if(e){if(l<=o){s="";continue}s+=e[0];break}}s+=n}return s.replace(/(\r\n|\n|\r)/g," ").trim()}(c,u,a,i,l);return d=r(d,function(e){const n={en:{single:{open:["'","‘","‛"],close:["'","’","‚"]},double:{open:['"',"“","″"],close:['"',"”","″"]}},fr:{single:{open:["'","‘"],close:["'","’"]},double:{open:["«",'"'],close:["»",'"']}},de:{single:{open:["'","‘"],close:["'","’"]},double:{open:['"',"„","“"],close:['"',"”"]}},es:{single:{open:["'","‘"],close:["'","’"]},double:{open:["«",'"'],close:["»",'"']}},it:{single:{open:["'","‘"],close:["'","’"]},double:{open:["«",'"'],close:["»",'"']}},pt:{single:{open:["'","‘"],close:["'","’"]},double:{open:["«",'"'],close:["»",'"']}},zh:{single:{open:["'"],close:["'"]},double:{open:['"'],close:['"']}},ja:{single:{open:["'"],close:["'"]},double:{open:['"'],close:['"']}},ko:{single:{open:["'"],close:["'"]},double:{open:['"'],close:['"']}},ar:{single:{open:["‘"],close:["’"]},double:{open:["“"],close:["”"]}},he:{single:{open:["‘"],close:["’"]},double:{open:["“"],close:["”"]}},ru:{single:{open:["'","‘"],close:["'","’"]},double:{open:["«",'"'],close:["»",'"']}},pl:{single:{open:["'","‘"],close:["'","’"]},double:{open:["„",'"'],close:["”"]}},tr:{single:{open:["'","‘"],close:["'","’"]},double:{open:['"'],close:['"']}},el:{single:{open:["'","‘"],close:["'","’"]},double:{open:['"',"«"],close:['"',"»"]}},vi:{single:{open:["'","‘"],close:["'","’"]},double:{open:['"'],close:['"']}}};return n[e]||n.en}(p)),d}}})(),LinkBuilder={forWordInDictionary:(e,n)=>{const t=n.replace(/\s+/g," ").trim();return e.replace("%s",encodeURIComponent(t))},forTranslationInText:(e,n)=>{let t=SentenceExtractor.extractSentence(n);return e.replace("%s",encodeURI(t))},forTranslationInVideo:(e,n)=>{let t=SentenceExtractor.extractSentence(n);return e.replace("%s",encodeURIComponent(t))},forTranslationInStudy:(e,n)=>{const t=n.parent("p").text().trim()||n.text();return e.replace("%s",encodeURIComponent(t))}};
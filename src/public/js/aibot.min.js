const AIBot={streamReply:async function(e,{onUpdate:o,onDone:t,onError:n}={}){let r=!0,a="";try{const n=await fetch("/ajax/getaireply.php",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:`prompt=${encodeURIComponent(e)}`});if(!n.ok)throw new Error("Failed to get AI response");const c=n.body.getReader(),d=new TextDecoder;for(;;){const{value:e,done:t}=await c.read();if(t)break;let n=d.decode(e,{stream:!0});r&&(n=n.trimStart(),r=!1),a+=n,"function"==typeof o&&o(a)}"function"==typeof t&&t(a)}catch(e){"function"==typeof n&&n(e)}}};
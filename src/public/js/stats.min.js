$(document).ready((function(){!async function(){const t=new URLSearchParams(window.location.search).get("u");try{const n=new URLSearchParams({type:"words"});t&&n.append("u",t);const a=await fetch(`/ajax/getwordsbystatus.php?${n.toString()}`);if(!a.ok)throw new Error(`HTTP error: ${a.status}`);const o=await a.json();if(!o.success)throw new Error(o.error_msg||"Stats retrieval unsuccessful.");!function(t){const n=parseInt(t[0]),a=parseInt(t[1]),o=parseInt(t[2]),r=parseInt(t[3]),s=parseInt(t[4]),i=document.getElementById("total-stats-canvas").getContext("2d"),c={id:"noDataPlugin",afterDraw:t=>{if(0===s){const e=t.ctx,{width:n,height:a}=t;e.save(),e.textAlign="center",e.textBaseline="middle",e.font="16px Arial",e.fillStyle="gray",e.fillText("No Data Available",n/2,a/2),e.restore()}}};new Chart(i,{type:"doughnut",data:{labels:["Learned","Learning","New","Forgotten"],datasets:[{data:[n,a,o,r],backgroundColor:["#3cb371","#ffa500","#1e90ff","#E0115F"],hoverOffset:4}]},options:{responsive:!0,plugins:{legend:{display:s,position:"right"},tooltip:{callbacks:{label:e}}}},plugins:[c]});s&&($("#learned-count").text(n),$("#learned-percentage").text((n/s*100).toFixed(2).toLocaleString("en-US")),$("#learning-count").text(a),$("#learning-percentage").text((a/s*100).toFixed(2).toLocaleString("en-US")),$("#new-count").text(o),$("#new-percentage").text((o/s*100).toFixed(2).toLocaleString("en-US")),$("#forgotten-count").text(r),$("#forgotten-percentage").text((r/s*100).toFixed(2).toLocaleString("en-US")),$("#total-count").text(n+a+o+r))}(o.payload)}catch(t){!function(){let t="<div class='d-flex align-items-center justify-content-center' style='min-height:400px;'><p class='text-danger'>Error: no data to display</p></div>";$("#total-stats-canvas").replaceWith(t)}()}function e(t){const e=t.raw,n=(e/t.dataset.data.reduce(((t,e)=>t+e),0)*100).toFixed(1);return`${t.label}: ${e} (${n}%)`}}()}));
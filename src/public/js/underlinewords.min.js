const TextProcessor=(()=>{const e=["zh","ja","ko"],n={0:"learned",1:"learning",2:"new",3:"forgotten"};let t;return{underlineWords:function(t,r,o){let s=t.text,i=[],a="",l=[],c="";return t.user_words.forEach((e=>{e.is_phrase>0?(i.push(e),a+=e.word.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")+"|"):(l.push(e),c+=e.word+"|")})),a=a.slice(0,-1),c=c.slice(0,-1),s=function(t,r,o,s,i){let a="";const l=o?" style='display: none;'":"";s.length>0&&(a=e.includes(r)?new RegExp("(?:<[^>]*>)|("+i+")","iug"):new RegExp("(?:<[^>]*>)|(?<![\\p{L}])("+i+")(?![\\p{L}])","iug"),t=t.replace(a,(function(e,t){if(void 0===t)return e;const r=s.find((n=>n.word.toLowerCase()===e.toLowerCase()));return"<a class='word reviewing "+n[r.status]+"' "+l+">"+t+"</a>"})));return t}(s,r,o,i,a),s=function(t,r,o,s,i){let a="";const l=o?" style='display: none;'":"";s.length>0&&(a=e.includes(r)?new RegExp("(?:s*<a class='word[^>]+>.*?</a>|<[^>]*>)|("+i+")","iug"):new RegExp("(?:s*<a class='word[^>]+>.*?</a>|<[^>]*>)|(?<![\\p{L}])("+i+")(?![\\p{L}])","iug"),t=t.replace(a,(function(e,t){if(void 0===t)return e;const r=s.find((n=>n.word.toLowerCase()===e.toLowerCase()));return"<a class='word reviewing "+n[r.status]+"' "+l+">"+t+"</a>"})));return t}(s,r,o,l,c),t.high_freq&&(s=function(n,t,r,o){let s="";const i=r?"style='display: none;'":"";o=o.join("|"),s=e.includes(t)?new RegExp("(?:s*<a class='word[^>]+>.*?</a>|<[^>]*>)|("+o+")","iug"):new RegExp("(?:s*<a class='word[^>]+>.*?</a>|<[^>]*>)|(?<![\\p{L}])("+o+")(?![\\p{L}])","iug");return n=n.replace(s,(function(e,n,t,r){return void 0===n?e:"<a class='word frequency-list' "+i+">"+n+"</a>"}))}(s,r,o,t.high_freq)),function(n,t,r){let o="",s="";const i=r?"style='display: none;'":"";return o=e.includes(t)?new RegExp(/(?:\s*<a class='word[^>]+>.*?<\/a>|<[^>]*>)|(\p{L})/giu):new RegExp(/(?:\s*<a class='word[^>]+>.*?<\/a>|<[^>]*>)|(\p{L}+)/giu),s=n.replace(o,(function(e,n){return void 0===n?e:'<a class="word" '+i+">"+n+"</a>"})),o=new RegExp(/(?<=<[^>]*>)([^\p{L}<]+)/gu),s=s.replace(o,(function(e,n){return void 0===n?e:"<a>"+n+"</a>"})),s}(s,r,o)},removeAllHighlighted:function(){t.filter(".highlighted").removeClass("highlighted")},addHighlightToSelection:function(e,n){const r=Math.min(e,n),o=Math.max(e,n);for(let e=r;e<=o;e++)t.eq(e).addClass("highlighted")},updateAnchorsList:function(){const e=$(parent.document).find("#text");t=e.find("a")},getAnchorIndex:function(e){return t.index(e)},getHighlightedTextObj:function(e,n){const r=Math.min(e,n),o=Math.max(e,n);let s=[];for(let e=r;e<=o;e++)s.push(t.eq(e)[0]);return $(s)},langHasNoWordSeparators:function(n){return e.includes(n)}}})();
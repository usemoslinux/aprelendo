$(document).ready((function(){function e(){const e=getCurrentFileName(),t=getCurrentURIParameters(),a={p:t.p?t.p:"1",ft:$(".ft.active").data("value")||0,fl:$(".fl.active").data("value")||0,s:$("#s").val().trim(),sa:$(".sa").hasClass("active")?"1":"0",o:$(".o.active").data("value")||0},i=buildQueryString(a);window.location.replace(e+i)}function t(){0===$("input[type=checkbox]:checked").length?$("#actions-menu").addClass("disabled"):$("#actions-menu").removeClass("disabled")}$("#search").focus(),$("input:checkbox").prop("checked",!1),$("#modal-achievements").length&&$("#modal-achievements").modal("show"),$("form").submit((function(t){t.preventDefault(),e()})),$("#mDelete, .imDelete").on("click",(function(){if(confirm("Really delete?")){let t=[];if("mDelete"===$(this).attr("id")?$("input.chkbox-selrow:checked").each((function(){t.push($(this).attr("data-idText"))})):$(this).hasClass("imDelete")&&t.push($(this).closest("tr").find("input").attr("data-idText")),0===t.length)return;const a="1"==getCurrentURIParameters().sa;$.ajax({url:"ajax/removetext.php",type:"POST",data:{textIDs:JSON.stringify(t),is_archived:a?1:0}}).done((function(){e()})).fail((function(){alert("There was an error when trying to delete the selected texts. Refresh the page and try again.")}))}})),$("#mArchive, .imArchive").on("click",(function(){const t="Archive"===$(this).text().trim();let a=[];$(this).hasClass("mArchive")?$("input.chkbox-selrow:checked").each((function(){a.push($(this).attr("data-idText"))})):$(this).hasClass("imArchive")&&a.push($(this).closest("tr").find("input").attr("data-idText")),0!==a.length&&$.ajax({url:"ajax/archivetext.php",type:"POST",data:{textIDs:JSON.stringify(a),archivetext:t}}).done((function(){e()})).fail((function(){alert("There was an error when trying to archive the selected texts. Refresh the page and try again.")}))})),$(".imShare").on("click",(function(){if(confirm("Sharing this text is irreversible. Once shared, it cannot be made private again. Are you sure you want to proceed?")){let t=$(this).closest("tr").find("input").attr("data-idText");if(void 0===t)return;$.ajax({url:"ajax/sharetext.php",type:"POST",data:{textID:t}}).done((function(t){null!=t.error_msg?alert(t.error_msg):e()})).fail((function(){alert("There was an error when trying to share the selected text. Refresh the page and try again.")}))}})),$(".imEdit").on("click",(function(){let e=$(this).closest("tr").find("input").attr("data-idText");void 0!==e&&(window.location.href="addtext?id="+encodeURIComponent(e))})),$(document).on("change",".chkbox-selrow",t),$(document).on("click","#chkbox-selall",(function(e){e.stopPropagation();$(".chkbox-selrow").prop("checked",$(this).prop("checked")),t()})),$("#btn-filter + div > a").on("click",(function(){const e=$(this);if(e.is(".sa"))e.toggleClass("active");else{e.addClass("active");let t="";e.is(".ft")?t=".ft":e.is(".fl")&&(t=".fl"),e.siblings(".active"+t).each((function(){$(this).toggleClass("active")}))}})),$("#dropdown-menu-sort .o").on("click",(function(e){const t=getCurrentFileName(),a={ft:$(".ft.active").data("value")||0,fl:$(".fl.active").data("value")||0,s:$("#s").val().trim(),sa:$(".sa").hasClass("active")?"1":"0",o:$(this).data("value")||0},i=buildQueryString(a);window.location.replace(t+i)})),$(document).on("click","li.disabled",(function(){return!1})),$("#welcome-close").on("click",(function(e){e.preventDefault(),setCookie("hide_welcome_msg",!0,3650)}))}));
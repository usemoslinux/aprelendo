$(document).ready((function(){function t(t){a();const o=function(t){if(""==t)return"";if(0===t.lastIndexOf("https://youtu.be/"))return t.slice(17);{const e=new Array("https://www.youtube.com/watch","https://youtube.com/watch","https://m.youtube.com/watch"),a=t.split("?"),o=a[1].split("&");for(const t of e)if(0===a[0].lastIndexOf(t))for(const t of o)if(0===t.lastIndexOf("v="))return t.substring(2)}}(t);if(""!=o){const a="https://www.youtube.com/embed/"+o;$("#error-msg").addClass("d-none"),$("#btn-fetch-img").removeClass().addClass("fas fa-sync fa-spin text-warning"),$.ajax({type:"POST",url:"ajax/fetchvideo.php",data:{video_id:o}}).done((function(o){void 0!==o&&(void 0!==o.error_msg?e(o.error_msg,"alert-danger"):($("#yt-video").length&&$("#yt-video").get(0).contentWindow.location.replace(a),$("#title").val(o.title),$("#author").val(o.author),$("#url").val(t),""==o.text?($("#text").val(""),e("This video does not include valid subtitles.","alert-danger")):($("#text").val(o.text),$("#alert-msg").addClass("d-none"))))})).fail((function(t,a,o){e("Oops! There was an unexpected error trying to get that video. Please try again later.","alert-danger")})).always((function(){$("#btn-fetch-img").removeClass().addClass("fas fa-arrow-down text-warning")}))}else e('Malformed Youtube URL link. It should have the following format: https://www.youtube.com/watch?v=video_id or https://youtu.be/video_id. Remember to replace "video_id" with the corresponding video ID and try again.',"alert-danger")}function e(t,e){$("#alert-msg").html(t).removeClass().addClass("alert "+e),$(window).scrollTop(0)}function a(){0==$("#external_call").length&&($("input").not(":hidden").val(""),$("#text").val(""),$("#yt-video").attr("src","about:blank"))}a(),$("#url").focus(),$("#form-addvideo").on("submit",(function(t){t.preventDefault();const a=$("#form-addvideo").serializeArray();a.push({name:"shared-text",value:!0}),$.ajax({type:"POST",url:"ajax/addtext.php",data:a}).done((function(t){void 0!==t?void 0!==t.error_msg&&e(t.error_msg,"alert-danger"):window.location.replace("/sharedtexts")})).fail((function(t,a,o){e("Oops! There was an unexpected error when uploading this text.","alert-danger")}))})),$("#external_call").length&&t($("#url").val()),$("#btn-fetch").on("click",(function(e){t($("#url").val())})),$("#url").on("paste",(function(e){t(e.originalEvent.clipboardData.getData("text"))}))}));
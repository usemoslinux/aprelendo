$(document).ready((function(){let e="",a="";const t=$("#dicFrame");let r=$(),n=[],d=10,o=0,s=0,c=0;function l(e,a){$("#alert-msg").html(e).removeClass().addClass("alert "+a),$(window).scrollTop(0)}function i(e){(function(){if(0==d)return $("#card-header").text("Sorry, no cards to practice"),$("#card-text").html("<div class='fas fa-exclamation-circle text-danger display-3'></div><div class='mt-3'>It seems you don't have any cards left for learning.</div>"),$("#card-footer").addClass("d-none"),$("#card-loader").addClass("d-none"),!0;if(s>d-1)return $("#card-header").text("Congratulations!"),$("#card-text").html("<div class='fa-solid fa-flag-checkered text-primary display-3 mt-3'></div><div class='mt-3'>You have reached the end of your study.</div><div class='mt-3'>You recalled "+c/d*100+" % of the words ("+c+" out of "+d+").</div><div class='small mt-4'>If you want to continue, you can refresh this page (F5).<br>However, we strongly recommend that you keep your study sessions short and take rest intervals.</div>"),$("#card-footer").addClass("d-none"),$("#card-loader").addClass("d-none"),!0;return!1})()||($("#card-loader").removeClass("d-none"),$("#card-text").empty(),$("#card-header").html("<h3 class='m-0'>Looking for examples of <b>"+e+"</b>...</h3>"),$.ajax({type:"POST",url:"ajax/getcards.php",data:{word:e},dataType:"json"}).done((function(a){let t="",r=0;const c=new RegExp("[^\\n.?!]*(?<![\\p{L}])"+e+"(?![\\p{L}])[^\\n.?!]*[.?!\\n)]","gmiu"),l=new RegExp("(?<![\\p{L}|\\d])"+e+"(?![\\p{L}|\\d])","gmiu");if(a.forEach((e=>{let a;for(;null!==(a=c.exec(e.text));)a.index===c.lastIndex&&c.lastIndex++,r<3&&a.forEach(((e,a)=>{e=e.replace(l,(function(e,a){return void 0===a?e:"<a class='word fw-bold'>"+e.replace(/\s\s+/g," ")+"</a>"})),t+=t.search(e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"))>0?"":"<p>"+e+"</p>\n",r++}))})),""==t)return $("#card-header").html("Skipped <b>"+e+"</b>. No examples found."),o++,void i(n[o]);$("#card").data("word",e),$("#card-loader").addClass("d-none"),$("#card-counter").text(s+1+"/"+d),$("#card-header").html("<h3 class='m-0'>"+e+"</h3>"),$("#card-text").append(t),$(".btn-remember").prop("disabled",!1),o++,s++})).fail((function(e,a,t){l("Oops! There was an unexpected error trying to fetch example sentences for this word.","alert-danger")})))}function u(e){const t=e.parent("p").text().trim();return a.replace("%s",encodeURIComponent(t))}$("#btn-translate").removeClass("ps-0"),$("#btnremove").hide(),$("#btnadd").hide(),$("#btncancel").addClass("ms-auto").html("&#x2715"),$(".modal-header").addClass("p-0"),$(".btn-remember").prop("disabled",!0),$.ajax({url:"/ajax/getdicuris.php",type:"GET",dataType:"json"}).done((function(t){null==t.error_msg&&(e=t.dictionary_uri,a=t.translator_uri)})),$.ajax({type:"POST",url:"ajax/getcards.php",dataType:"json"}).done((function(e){n=e.map((function(e,a){return e.word})),d=n.length>d?d:n.length,$("#card-counter").text("1/"+d),i(n[0])})).fail((function(e,a,t){l("Oops! There was an unexpected error trying to fetch the list of words you are learning in this language.","alert-danger")})),$("body").on("click",".word",(function(a){r=$(this);const n=e.replace("%s",encodeURI(r.text()));$("#btnadd").text("Forgot"),$("#loading-spinner").attr("class","lds-ellipsis m-auto"),t.attr("class","d-none"),t.get(0).contentWindow.location.replace(n),$("#myModal").modal("show")})),t.on("load",(function(){$("#loading-spinner").attr("class","d-none"),t.removeClass()})),$(".btn-remember").click((function(e){e.preventDefault();const a=$("#card").data("word"),t="btn-remember-yes"==e.currentTarget.id;c=t?c+1:c,$(".btn-remember").prop("disabled",!0),$.ajax({type:"POST",url:"ajax/updatecard.php",data:{word:a,remember:t}}).done((function(e){i(n[o])})).fail((function(e,a,t){l("There was an unexpected error updating this word's status","alert-danger")}))})),$("#btn-translate").on("click",(function(){window.open(u(r))})),$(document).on("contextmenu",(function(e){return!/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)&&$(e.target).is(".word")&&window.open(u($(e.target))),!1}))}));
function buildTranslationLink(e,t){let n=$(),r=t,l=$(),a="",i=!1;const d=":contains('.'), :contains('。'), :contains('!'), :contains('?')";for(;!i;)0!==r.index()?(n=r.prevAll(d).last(),i=n.length>0||r.filter(d).length>0,n=i?n:r.siblings().addBack().first(),l=n.nextUntil(r).addBack().next().addBack(),a=l.text().replace(/(\r\n|\n|\r)/gm," ").trim()+" "+a,r=r.parent().prev().children().last(),i=i||0===r.length):(a=r.text().replace(/(\r\n|\n|\r)/gm," ").trim()+" ",r=r.parent().prev().children().last());r=$(),n=0===t.next().length?t:t.next();for(i=a.match(/[.。!?]/g);!i;)r=n.nextAll(d).last(),r=r.index()===r.parent().children().length?n:r,i=r.length>0||n.filter(d).length>0,r=i?r:n.siblings().last(),l=n.nextUntil(r).addBack().next().addBack(),a+=l.text().replace(/(\r\n|\n|\r)/gm," ").trim()+" ",n=n.parent().next().children().first();return e.replace("%s",encodeURIComponent(a.trim()))}function getWordFrequency(e,t){let n=$("#bdgfreqlvl");$.ajax({type:"GET",url:"/ajax/getwordfreq.php",data:{word:e,lg_iso:t}}).done((function(e){0==e?n.hide():e<81?n.hide().text("High frequency word").removeClass().addClass("badge text-bg-danger").show():e<97&&n.hide().text("Medium frequency word").removeClass().addClass("badge text-bg-warning").show()})).fail((function(){n.hide()}))}function setAddDeleteButtons(e){let t=$("#btnremove"),n=$("#btnadd"),r=e.filter(".learning, .new, .forgotten, .learned").length;e.filter(".word").length==r?!1===t.is(":visible")&&(t.show(),n.text("Forgot")):(t.hide(),n.text("Add"))}
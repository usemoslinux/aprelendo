function buildTranslationLink(e,t){let n=$(),r=t,l=$(),i="",a=!1;const d=":contains('.'), :contains('。'), :contains('!'), :contains('?')";for(;!a;){if(0===r.index()){i=r.text().replace(/(\r\n|\n|\r)/gm," ").trim();break}if(r.filter(d).length>0)break;n=r.prevAll(d).next().last(),a=n.length>0||r.filter(d).length>0,n=a?n:r.siblings().addBack().first(),l=n.nextUntil(r).addBack().next().addBack(),i=l.text().replace(/(\r\n|\n|\r)/gm," ").trim()+" "+i,r=r.parent().prev().children().last(),a=a||0===r.length}r=$(),n=0===t.next().length?t:t.next();let o;for(a=i.match(/[.。!?]/g);!a;)r=n.nextAll(d).first(),r=r.index()===r.parent().children().length?n:r,a=r.length>0||n.filter(d).length>0,r=a?r:n.siblings().last(),n.filter(d).length>0?(l=n,o=""):(l=n.nextUntil(r).addBack().next().addBack(),o=" "),i=i.trim()+o+l.text().replace(/(\r\n|\n|\r)/gm," ").trim(),n=n.parent().next().children().first();return e.replace("%s",encodeURIComponent(i.trim()))}function getWordFrequency(e,t){let n=$("#bdgfreqlvl");$.ajax({type:"GET",url:"/ajax/getwordfreq.php",data:{word:e,lg_iso:t}}).done((function(e){0==e?n.hide():e<81?n.hide().text("High frequency word").removeClass().addClass("badge text-bg-danger").show():e<97&&n.hide().text("Medium frequency word").removeClass().addClass("badge text-bg-warning").show()})).fail((function(){n.hide()}))}function setAddDeleteButtons(e){let t=$("#btnremove"),n=$("#btnadd"),r=e.filter(".learning, .new, .forgotten, .learned").length;e.filter(".word").length==r?!1===t.is(":visible")&&(t.show(),n.text("Forgot")):(t.hide(),n.text("Add"))}
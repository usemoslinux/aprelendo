function buildTranslationLink(e,t){let n,r=t,a=$(),l="",i=!1;const d=":contains('.'), :contains('。'), :contains('!'), :contains('?')";for(;!i;){if(0===r.index()){l=r.text().replace(/(\r\n|\n|\r)/gm," ").trim();break}if(r.filter(d).length>0)break;n=r.prevAll(d).next().last(),i=n.length>0||r.filter(d).length>0,n=i?n:r.siblings().addBack().first(),a=n.nextUntil(r).addBack().next().addBack(),l=a.text().replace(/(\r\n|\n|\r)/gm," ").trim()+" "+l,r=r.parent().prev().children().last(),i=i||0===r.length}n=0===t.next().length?t:t.next();let s;for(i=l.match(/[.。!?]/g);!i;)r=n.nextAll(d).first(),r=r.index()===r.parent().children().length?n:r,i=r.length>0||n.filter(d).length>0,r=i?r:n.siblings().last(),n.filter(d).length>0?(a=n,s=""):(a=n.nextUntil(r).addBack().next().addBack(),s=" "),l=l.trim()+s+a.text().replace(/(\r\n|\n|\r)/gm," ").trim(),n=n.parent().next().children().first();return e.replace("%s",encodeURIComponent(l.trim()))}function getWordFrequency(e,t){let n=$("#bdgfreqlvl");$.ajax({type:"GET",url:"/ajax/getwordfreq.php",data:{word:e,lg_iso:t}}).done((function(e){0==e?n.hide():e<81?n.hide().text("High frequency word").removeClass().addClass("badge text-bg-danger").show():e<97&&n.hide().text("Medium frequency word").removeClass().addClass("badge text-bg-warning").show()})).fail((function(){n.hide()}))}function setAddDeleteButtons(e){let t=$("#btnremove"),n=$("#btnadd"),r=e.filter(".learning, .new, .forgotten, .learned").length;e.filter(".word").length==r?!1===t.is(":visible")&&(t.show(),n.text("Forgot").removeClass("btn-primary").addClass("btn-danger")):(t.hide(),n.text("Add").removeClass("btn-danger").addClass("btn-primary"))}